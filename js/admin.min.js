!function($){$(function(){function hidePrettyBenchSelect(){$("body").removeClass("show-bench-select"),$("#pretty-bench-select-table td").removeClass("disabled").removeClass("current")}function registryUpdate($this){$this.prop("disabled",!0).after('<img class="loading-spinner" width=20 height=20 src="'+server_data.loading_spinner_url+'" />').addClass("loading");const registry=$this.attr("data-registry"),field=$this.attr("name"),value="checkbox"!==$this.attr("type")?$this.val():$this.is(":checked")?"1":"0";$.post(ajaxurl,{action:"update_registry",_wpnonce:server_data.update_registry_nonce,registry:registry,field:field,value:value},function(r){var editRegistryLink=$this.prevAll(".edit-registry-field"),fieldValLabel=$this.prevAll(".value-label").first();if($this.prop("disabled",!1).removeClass("loading").next(".loading-spinner").remove().end(),editRegistryLink.removeClass("show-input"),1==r.success){if($this.after('<span style="color:green;">'+r.message+"</span>"),fieldValLabel.text(r.value),"baptism_date"===field||"baptism_date_private"===field)$(".input_benches[data-registry="+registry+"]").val("").find("option").each(function(){$(this).prop("disabled",!1)}).end().prevAll(".value-label").text("").end(),r.unavailable_benches&&r.unavailable_benches.forEach(function(b){$(".input_benches[data-registry="+registry+"] option[value="+b+"]").prop("disabled",!0)}),"baptism_date"===field?$(".input_baptism_date_private[data-registry="+registry+"]").val(r.value):$(".input_baptism_date[data-registry="+registry+"]").val(r.value);else if("benches"===field&&r.previous_bench){const baptism_date=$(".input_baptism_date[data-registry="+registry+"]").val();$this.nextAll(".placita-select").attr("data-value",r.value),$(".input_baptism_date").filter(function(){return this.value==baptism_date}).each(function(){const _registry=$(this).attr("data-registry");$(".input_benches[data-registry="+_registry+"] option[value="+r.previous_bench+"]").prop("disabled",!1),$(".input_benches[data-registry="+_registry+"] option[value="+r.value+"]").prop("disabled",!0)})}else"is_private"===field&&(1==r.dbVal?$(".input_baptism_date[data-registry="+registry+"]").prevAll("a.edit-registry-field").addClass("is_private"):$(".input_baptism_date[data-registry="+registry+"]").prevAll("a.edit-registry-field").removeClass("is_private"));setTimeout(function(){const successMsg=$this.next("span");successMsg.fadeOut(500,function(){successMsg.remove()})},700)}else alert(r.message)})}$(".confirm-action").click(function(e){return confirm_msg=$(this).attr("data-confirm_msg"),"checkbox"!==$(this).attr("type")||$(this).is(":checked")||(confirm_msg="un"+confirm_msg),confirm("Are you sure you want to "+confirm_msg+"?")}),$(".edit-registry-field").click(function(e){e.preventDefault(),$(this).addClass("show-input")}),$(".registries_export_date, .print_certificates_date").datetimepicker({disabledWeekDays:[1,2,3,4],allowTimes:["7:30","9:30","11:30","13:15","13:30","15:15"],format:"m/d/Y H:i",scrollMonth:!1,scrollTime:!1,scrollInput:!1,onSelectDate:function(ct,$this){const day=ct.getDay(),times=[];switch(day){case 0:times.push("9:30","11:30","13:30");break;case 5:times.push("13:30");break;case 6:times.push("7:30","9:30","11:30","13:15","15:15")}$this.datetimepicker("setOptions",{allowTimes:times})},onSelectTime:function(ct,$this){$this.blur()}}),$(".input_baptism_date").datetimepicker({disabledWeekDays:[1,2,3,4],allowTimes:["7:30","9:30","11:30","13:15","13:30","15:15"],format:"m/d/Y H:i",scrollMonth:!1,scrollTime:!1,scrollInput:!1,onSelectDate:function(ct,$this){const day=ct.getDay(),times=[];switch(day){case 0:times.push("9:30","11:30","13:30");break;case 5:times.push("13:30");break;case 6:times.push("7:30","9:30","11:30","13:15","15:15")}$this.datetimepicker("setOptions",{allowTimes:times})},onSelectTime:function(ct,$this){$this.blur(),registryUpdate($this)}}),$(".input_baptism_date_private").datetimepicker({format:"m/d/Y H:i",step:30,scrollMonth:!1,scrollTime:!1,scrollInput:!1,onSelectTime:function(ct,$this){$this.blur(),registryUpdate($this)}}),$(".input_birthdate").datetimepicker({format:"m/d/Y",timepicker:!1,onSelectDate:function(ct,$this){$this.blur(),registryUpdate($this)}}),$(".registry-update").keydown(function(e){if(13==e.keyCode)return e.preventDefault(),$(this).blur(),!1}),$(".input_benches").hide().after(function(){const val=$(this).val(),reg=$(this).attr("data-registry");return"<span class='placita-select registry-update' data-registry='"+reg+"' data-value='"+val+"' ></span>"}),$(".benches").on("click",".placita-select",function(e){e.preventDefault();const reg=$(this).attr("data-registry"),disabled=$(this).prevAll(".input_benches").find("option:disabled"),current=$(this).prevAll(".input_benches").find("option:selected");if($.each(disabled,function(i,dis){const value=$(dis).val();$('#pretty-bench-select-table td[data-value="'+value+'"]').addClass("disabled")}),current){const value=current.val();$('#pretty-bench-select-table td[data-value="'+value+'"]').addClass("current").removeClass("disabled")}$("body").addClass("show-bench-select"),$("#pretty-bench-select-table").attr("data-registry",reg)}),$(".pretty-bench-select").click(function(e){$(e.target).hasClass("pretty-bench-select")&&hidePrettyBenchSelect()}),$("#pretty-bench-select-table td").click(function(){if($(this).hasClass("disabled")||$(this).hasClass("current"))return!1;const val=$(this).attr("data-value"),reg=$("#pretty-bench-select-table").attr("data-registry");$(".input_benches[data-registry="+reg+"]").val(val).change(),hidePrettyBenchSelect()}),$(".registry-update:not(.datetimepicker)").change(function(){registryUpdate($(this))})})}(jQuery);